<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/jpg" href="../static/images/favicon.ico"/>-->
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  <title>Confirm Booking</title>
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
    
    .payment-form {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      background-color: #fff;
    }
    
    .payment-header {
      text-align: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .btn-pay {
      background-color: #3f86f4;
      color: white;
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      font-weight: bold;
      margin-top: 15px;
    }
    
    .btn-pay:hover {
      background-color: #2d6cdd;
    }
    
    .card-icons {
      display: flex;
      justify-content: center;
      margin-bottom: 15px;
    }
    
    .card-icon {
      margin: 0 5px;
      width: 40px;
      height: 25px;
    }
    
    .payment-method-tabs {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      border-bottom: 1px solid #dee2e6;
    }
    
    .payment-method-tab {
      flex: 1;
      text-align: center;
      padding: 10px;
      cursor: pointer;
      border-radius: 4px 4px 0 0;
      border: 1px solid transparent;
      transition: all 0.3s;
    }
    
    .payment-method-tab.active {
      background-color: #fff;
      border-color: #dee2e6;
      border-bottom-color: #fff;
      margin-bottom: -1px;
      font-weight: bold;
    }
    
    .payment-method-content {
      display: none;
    }
    
    .payment-method-content.active {
      display: block;
    }
    
    .form-check {
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .form-check input {
      margin-right: 10px;
    }
    
    .dummy-notice {
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      color: #856404;
      padding: 10px;
      border-radius: 4px;
      margin-top: 15px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: bold;
    }
    
    .is-invalid {
      border-color: #dc3545 !important;
      padding-right: calc(1.5em + 0.75rem);
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right calc(0.375em + 0.1875rem) center;
      background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .is-valid {
      border-color: #198754 !important;
      padding-right: calc(1.5em + 0.75rem);
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right calc(0.375em + 0.1875rem) center;
      background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .invalid-feedback {
      display: none;
      width: 100%;
      margin-top: 0.25rem;
      font-size: 0.875em;
      color: #dc3545;
    }
    
    .is-invalid ~ .invalid-feedback {
      display: block;
    }
    
    .upi-examples .badge {
      transition: all 0.2s;
      background-color: #f8f9fa;
      color: #212529;
      margin-right: 5px;
      margin-bottom: 5px;
      cursor: pointer;
    }
    
    .upi-examples .badge:hover {
      background-color: #e2e6ea !important;
      transform: scale(1.05);
    }
  </style>
  <!-- Custom styles for this template -->
  <link href="form-validation.css" rel="stylesheet">
</head>


<body class="bg-light">
  <div class="container">
    <div class="py-5 text-center">
      <h2>Checkout form</h2>
    </div>
    <!-- <form class="needs-validation" action="Booked" method="post"> -->
      <!-- {% csrf_token %} -->
      <div class="row">
        <div class="col-md-4 order-md-2 mb-4">
          <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-muted">Amount Payable</span>
            <span class="badge badge-secondary badge-pill">3</span>
          </h4>
          <ul class="list-group mb-3">
            <li class="list-group-item d-flex justify-content-between lh-condensed">

            <li class="list-group-item d-flex justify-content-between">
              <span>Total (Rs)</span>
              <strong> <input  type="text" name="total_amount" value="{{details.totalAmount}}" readonly></strong>
            </li>
          </ul>
        </div>
        <div class="col-md-8 order-md-1">
          <h4 class="mb-3">Billing address</h4>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="username">UserName</label>

              <input type="text" class="form-control" id="username" placeholder="" value="{{details.username}}" name="username"
                readonly>
              <div class="invalid-feedback">
                Valid first name is required.
              </div>
            </div>

          </div>


          <div class="mb-3">
            <label for="email">Email <span class="text-muted"></span></label>
            <input type="email" class="form-control" id="email" placeholder="you@example.com" value=" {{details.email}}"
              name="email" readonly>
            <div class="invalid-feedback">
              Please enter a valid email address for shipping updates.
            </div>
          </div>

          <div class="mb-3">
            <label for="address">Selected Date</label>
            <input type="text" class="form-control" id="selectedDate" value="{{details.selectedDate}}"
              name="selected_date" readonly>
          </div>

          <div class="mb-3">
            <label for="address2">Current Date <span class="text-muted"></span></label>
            <input type="text" name="current_date" class="form-control" id="add" value="{{details.currentDate}}"
              readonly>
          </div>

          <hr class="mb-4">
          <div class="custom-control custom-checkbox">
            <label style="margin-bottom: 3rem;" class="custom-control-label" for="same-address">Booked Slots</label>

            {% for time in details.bookedSlots %}

            <input type="text" class="custom-control-input" name="slots" id="same-address" value="{{time}}" readonly>
           
            {% endfor %}
          </div>
        </div>
    </div>
  </div>

<!-- Secure Payment Gateway -->
<div class="container my-5">
    <div class="payment-container">
        <div class="payment-form">
            <div class="payment-header">
                <h3>Complete Payment</h3>
                <p>Total Amount: â‚¹{{ details.totalAmount }}.00</p>
            </div>
            
            <div class="dummy-notice">
                <i class="fas fa-info-circle me-2"></i> This is a simulation for demonstration purposes only.
            </div>
            
            <div class="payment-method-tabs">
                <div class="payment-method-tab active" data-method="credit_card">
                    <i class="far fa-credit-card"></i> Card
                </div>
                <div class="payment-method-tab" data-method="upi">
                    <i class="fas fa-mobile-alt"></i> UPI
                </div>
                <div class="payment-method-tab" data-method="net_banking">
                    <i class="fas fa-university"></i> Net Banking
                </div>
                <div class="payment-method-tab" data-method="wallet">
                    <i class="fas fa-wallet"></i> Wallet
                </div>
            </div>
            
            <form action="{% url 'success' %}" method="post" id="paymentForm">
                {% csrf_token %}
                
                <!-- Hidden fields for booking info -->
                <input type="hidden" name="order_id" value="{{ payment.id }}">
                <input type="hidden" name="username" value="{{ details.username }}">
                <input type="hidden" name="email" value="{{ details.email }}">
                <input type="hidden" name="selected_date" value="{{ details.selectedDate }}">
                <input type="hidden" name="current_date" value="{{ details.currentDate }}">
                <input type="hidden" name="total_amount" value="{{ details.totalAmount }}">
                <input type="hidden" name="booking_time" value="{{ details.booking_time }}">
                <input type="hidden" id="paymentMethodInput" name="payment_method" value="credit_card">
                
                <!-- For slots -->
                {% for slot in details.bookedSlots %}
                <input type="hidden" name="booked_slots" value="{{ slot }}">
                {% endfor %}
                
                <!-- Credit Card Payment Method -->
                <div class="payment-method-content active" id="credit_card">
                    <!--<div class="card-icons text-center mb-3">
                        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/visa/visa-original.svg" alt="Visa" class="card-icon">
                        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/visa/visa-original.svg" alt="Mastercard" class="card-icon">
                        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/visa/visa-original.svg" alt="Amex" class="card-icon">
                    </div>-->
                    
                    <div class="form-group">
                        <label for="cardName">Name on Card</label>
                        <input type="text" class="form-control" id="cardName" placeholder="John Smith" required>
                        <div class="invalid-feedback">
                            Please enter the name as it appears on your card
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" class="form-control" id="cardNumber" placeholder="4111 1111 1111 1111" required>
                        <small class="text-muted">Enter any 16-digit number</small>
                        <div class="invalid-feedback">
                            Please enter a valid card number
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="expDate">Expiration Date</label>
                                <input type="text" class="form-control" id="expDate" placeholder="MM/YY" required>
                                <div class="invalid-feedback">
                                    Please enter a valid expiration date
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="cvv">CVV</label>
                                <input type="text" class="form-control" id="cvv" placeholder="123" required>
                                <div class="invalid-feedback">
                                    Please enter the 3-digit security code
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- UPI Payment Method -->
                <div class="payment-method-content" id="upi">
                    <div class="form-group">
                        <label for="upiId">UPI ID</label>
                        <input type="text" class="form-control" id="upiId" placeholder="yourname@upi" required>
                        <div class="invalid-feedback">
                            Please enter a valid UPI ID (e.g., username@ybl)
                        </div>
                        <small class="text-muted">Valid formats: username@ybl, username@upi, username@ibl, username@paytm, etc.</small>
                    </div>
                    
                    <div class="upi-examples mt-2">
                        <p class="text-muted mb-1">Quick select:</p>
                        <span class="badge bg-light text-dark">name@ybl</span>
                        <span class="badge bg-light text-dark">name@upi</span>
                        <span class="badge bg-light text-dark">name@ibl</span>
                        <span class="badge bg-light text-dark">name@paytm</span>
                    </div>
                    
                    <div class="form-check mt-3">
                        <input class="form-check-input" type="radio" name="upiProvider" id="googlePay" checked>
                        <label class="form-check-label" for="googlePay">
                            <i class="fab fa-google-pay"></i> Google Pay
                    </label>
                </div>
                
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="upiProvider" id="phonePe">
                        <label class="form-check-label" for="phonePe">
                            <i class="fas fa-mobile-alt"></i> PhonePe
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="upiProvider" id="paytmUpi">
                        <label class="form-check-label" for="paytmUpi">
                            <i class="fas fa-money-bill"></i> Paytm
                        </label>
                    </div>
                </div>
                
                <!-- Net Banking Payment Method -->
                <div class="payment-method-content" id="net_banking">
                    <div class="form-group">
                        <label>Select Bank</label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="netBankingBank" id="hdfcBank" checked>
                        <label class="form-check-label" for="hdfcBank">
                            HDFC Bank
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="netBankingBank" id="sbiBank">
                        <label class="form-check-label" for="sbiBank">
                            State Bank of India
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="netBankingBank" id="iciciBank">
                        <label class="form-check-label" for="iciciBank">
                            ICICI Bank
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="netBankingBank" id="axisBank">
                        <label class="form-check-label" for="axisBank">
                            Axis Bank
                        </label>
                    </div>
                </div>
                
                <!-- Wallet Payment Method -->
                <div class="payment-method-content" id="wallet">
                    <div class="form-group">
                        <label>Select Wallet</label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="walletProvider" id="paytmWallet" checked>
                        <label class="form-check-label" for="paytmWallet">
                            <i class="fas fa-wallet"></i> Paytm
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="walletProvider" id="amazonPay">
                        <label class="form-check-label" for="amazonPay">
                            <i class="fab fa-amazon-pay"></i> Amazon Pay
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="walletProvider" id="mobikwik">
                        <label class="form-check-label" for="mobikwik">
                            <i class="fas fa-money-bill-wave"></i> MobiKwik
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="walletProvider" id="freecharge">
                        <label class="form-check-label" for="freecharge">
                            <i class="fas fa-bolt"></i> Freecharge
                        </label>
                    </div>
                    
                    <div class="form-group mt-3">
                        <label for="walletMobile">Mobile Number</label>
                        <input type="text" class="form-control" id="walletMobile" placeholder="Enter mobile number" required>
                        <small class="text-muted">Enter your 10-digit mobile number without country code.</small>
                        <div class="invalid-feedback">
                            Please enter a valid 10-digit mobile number
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-pay mt-4">Pay Now (â‚¹{{ details.totalAmount }}.00)</button>
                
                <div class="mt-3 text-center">
                    <small class="text-muted">This payment simulation is for demonstration purposes only. No real transactions will be processed and no actual payment information is being collected.</small>
                </div>
                
                <!--<div class="alert alert-warning mt-3" role="alert">
                    <small><strong>Note:</strong> Your slot booking will only be confirmed after clicking "Pay Now". You can cancel anytime before payment.</small>
                </div>-->
            </form>
        </div>
    </div>
</div>

  <!-- Optional JavaScript; choose one of the two! -->

  <!-- Option 1: Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
    
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Validation rules for different input types
        const validationRules = {
            cardNumber: {
                format: (value) => {
                    const digits = value.replace(/\D/g, '').substring(0, 16);
                    return digits.replace(/(.{4})/g, '$1 ').trim();
                },
                validate: (value) => value.replace(/\s/g, '').length === 16
            },
            expDate: {
                format: (value) => {
                    value = value.replace(/\D/g, '');
                    return value.length > 2 ? value.substring(0, 2) + '/' + value.substring(2, 4) : value;
                },
                validate: (value) => /^\d{2}\/\d{2}$/.test(value) && parseInt(value.substring(0, 2)) <= 12
            },
            cvv: {
                format: (value) => value.replace(/\D/g, '').substring(0, 3),
                validate: (value) => /^\d{3}$/.test(value)
            },
            upiId: {
                validate: (value) => /^[a-zA-Z0-9._-]+@[a-zA-Z]{3,}$/.test(value)
            },
            walletMobile: {
                format: (value) => {
                    value = value.replace(/\D/g, '');
                    if (!value.startsWith('91') && value.length > 0) value = '91' + value;
                    return value.substring(0, 12);
                },
                validate: (value) => /^91[6-9]\d{9}$/.test(value),
                placeholder: "91XXXXXXXXXX"
            }
        };

        // Add validation to all inputs
        document.querySelectorAll('.form-control').forEach(input => {
            const rule = validationRules[input.id];
            if (!rule) return;

            if (rule.placeholder) input.placeholder = rule.placeholder;
            
            input.addEventListener('input', function() {
                if (rule.format) {
                    this.value = rule.format(this.value);
                }
                const isValid = rule.validate(this.value);
                this.classList.toggle('is-valid', isValid);
                this.classList.toggle('is-invalid', !isValid && this.value.length > 0);
            });
        });
        
        // Payment method tabs handling
        const paymentMethodInput = document.getElementById('paymentMethodInput');
        document.querySelectorAll('.payment-method-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Update active tab and content
                document.querySelectorAll('.payment-method-tab, .payment-method-content').forEach(el => el.classList.remove('active'));
                this.classList.add('active');
                const method = this.dataset.method;
                document.getElementById(method).classList.add('active');
                paymentMethodInput.value = method;
                
                // Update required fields
                document.querySelectorAll('input[required]').forEach(input => input.required = false);
                document.querySelectorAll(`#${method} input`).forEach(input => input.required = true);
            });
        });
        
        // Form submission validation
        document.getElementById('paymentForm').addEventListener('submit', function(e) {
            const activeMethod = document.querySelector('.payment-method-tab.active').dataset.method;
            const requiredInputs = document.querySelectorAll(`#${activeMethod} input[required]`);
            let isValid = true;

            requiredInputs.forEach(input => {
                const rule = validationRules[input.id];
                if (rule && !rule.validate(input.value)) {
                    input.classList.add('is-invalid');
                    isValid = false;
                }
            });

            if (!isValid) {
                e.preventDefault();
                alert('Please fill in all required fields correctly.');
                }
        });

        // Quick UPI handle selection
        document.querySelectorAll('.upi-examples .badge').forEach(badge => {
            badge.addEventListener('click', () => {
                const upiInput = document.getElementById('upiId');
                upiInput.value = badge.textContent;
                upiInput.dispatchEvent(new Event('input'));
            });
        });
    });
  </script>
</body>

</html>